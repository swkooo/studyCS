# Q1. String, StringBuilder, StringBufferì˜ ì°¨ì´ì ì€ ?

### âœ… ë‹µë³€ !
3ê°€ì§€ ëª¨ë‘ **ë¬¸ìì—´**ì„ ë‹¤ë£¨ëŠ” ìë£Œí˜• í´ë˜ìŠ¤ì´ë‚˜

**String**ì€ í•œ ë²ˆ ìƒì„±ë˜ë©´ ê°’ì„ ë³€ê²½í•  ìˆ˜ ì—†ëŠ” **ë¶ˆë³€ ê°ì²´**, 
**StringBuilder**ì™€ **StringBuffer**ëŠ” ë¬¸ìì—´ì„ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” **ê°€ë³€ ê°ì²´**ì…ë‹ˆë‹¤. 
ë˜í•œ, **StringBuffer**ëŠ” ë©€í‹° ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ **ì•ˆì „í•œ ë™ê¸°í™”ë¥¼ ì§€ì›**í•˜ì§€ë§Œ, **StringBuilder**ëŠ” ì´ë¥¼ **ì§€ì›í•˜ì§€ ì•Šì•„** ì‹±ê¸€ ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ë” ë¹ ë¥¸ ì„±ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

---

## ğŸ” ì¶”ê°€ ì„¤ëª…

### 1. String
```java
StringÂ  strÂ  =Â  "hello";Â  Â  Â  Â //Â  String str = new String("hello");
strÂ  =Â  strÂ  +Â  Â "world";Â  Â  Â  Â  //Â  [Â  helloÂ  worldÂ  ]
```
- strì€ â€œhello worldâ€ ë¼ëŠ” ê°’ì„ ê°€ì§€ê³  ìˆëŠ” ìƒˆë¡œìš´ ë©”ëª¨ë¦¬ ì˜ì—­ì„ ê°€ë¦¬í‚¤ê²Œ ë³€ê²½
- ì²˜ìŒ ì„ ì–¸í–ˆë˜ â€œhelloâ€ ë¡œ ê°’ì´ í• ë‹¹ë˜ì–´ ìˆë˜ ë©”ëª¨ë¦¬ ì˜ì—­ì€ GCì— ì˜í•´ ì œê±°
  â†’ String í´ë˜ìŠ¤ëŠ” ë¶ˆë³€í•˜ê¸° ë•Œë¬¸ì— ë¬¸ìì—´ì„ ìˆ˜ì •í•˜ëŠ” ì‹œì ì— ìƒˆë¡œìš´ String ì¸ìŠ¤í„´ìŠ¤ ìƒì„± !
- String pool ì— ì €ì¥
- ë¶ˆë³€ì„± íŠ¹ì§•ìœ¼ë¡œ thread-safe

![String ë©”ëª¨ë¦¬ êµ¬ì¡°](image/string.png)

- ë³€í•˜ì§€ ì•ŠëŠ” ë¬¸ìì—´ì„ ìì£¼ ì¡°íšŒí•  ê²½ìš° ì„±ëŠ¥ì´ ì¢‹ìŒ  
- ë¬¸ìì—´ ì¶”ê°€, ìˆ˜ì •, ì‚­ì œ ë“± ì—°ì‚°ì´ ë¹ˆë²ˆí•˜ê²Œ ë°œìƒí•˜ëŠ” ê²½ìš° í™ ë©”ëª¨ë¦¬ì— ë§ì€ Garbageê°€ ìƒì„±ë˜ì–´ ì„±ëŠ¥ì— ì˜í–¥

**ìë°”ì—ì„œ Stringì„ ë¶ˆë³€ìœ¼ë¡œ ì„¤ì •í•œ ì´ìœ **
1. ìºì‹±  
2. ë³´ì•ˆ  
3. ë™ê¸°í™”  


### 2. StringBuffer / StringBuilder
- **ê°€ë³€ ê°ì²´** â†’ ë™ì¼ ê°ì²´ ë‚´ì—ì„œ ë¬¸ìì—´ ë³€ê²½ ê°€ëŠ¥  
- í™ ì˜ì—­ì— ì €ì¥  
- ë©”ëª¨ë¦¬ ë¸”ëŸ­ì—ì„œ ê¸¸ì´ ë³€ê²½ ê°€ëŠ¥  
  - ê¸°ë³¸ ê¸¸ì´ 16ìœ¼ë¡œ ìƒì„±  
  - `.append()` ì‹œ ìë™ í™•ì¥  

![StringBuffer êµ¬ì¡°](image/stringbuffer.png)

#### StringBuffer
- ë‚´ë¶€ì ìœ¼ë¡œ **synchronized** ì‚¬ìš©  
- ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ **thread-safe**  
- ë™ê¸°í™”ë¡œ ì¸í•´ ì„±ëŠ¥ì€ `StringBuilder`ë³´ë‹¤ ëŠë¦¼  

ğŸ’¡ **synchronized í‚¤ì›Œë“œë€?**  
ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— í•˜ë‚˜ì˜ ìì›ì— ì ‘ê·¼í•˜ë ¤ê³  í•  ë•Œ,  
í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ ìŠ¤ë ˆë“œë¥¼ ì œì™¸í•˜ê³ ëŠ” ì ‘ê·¼í•˜ì§€ ëª»í•˜ë„ë¡ ë§‰ëŠ” ì—­í•   

#### StringBuilder
- ë™ê¸°í™” ë¯¸ì§€ì›  
- ë‹¨ì¼ ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ì„±ëŠ¥ ìš°ìˆ˜ (ë¹ ë¦„)  
- ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œëŠ” ë™ì‹œ ì ‘ê·¼ ì‹œ ë°ì´í„° ì†ì‹¤ ë°œìƒ

ì˜ˆì‹œ)
StringBuilder, StringBuffer ê°ì²´ì— ê°ê° 1ìš”ì†Œë¥¼ 1ë§Œë²ˆ append ë¡œì§ ìˆ˜í–‰ ì‹œ?

```java
import java.util.*;

public class Main extends Thread{
  public static void main(String[] args) {
    StringBuffer stringBuffer = new StringBuffer();
    StringBuilder stringBuilder = new StringBuilder();

    new Thread(() -> {
        for(int i=0; i<10000; i++) {
            stringBuffer.append(1);
            stringBuilder.append(1);
        }
    }).start();

    new Thread(() -> {
        for(int i=0; i<10000; i++) {
            stringBuffer.append(1);
            stringBuilder.append(1);
        }
    }).start();

    new Thread(() -> {
        try {
            Thread.sleep(2000);

            System.out.println("StringBuffer.length: "+ stringBuffer.length()); // thread safe í•¨
            System.out.println("StringBuilder.length: "+ stringBuilder.length()); // thread unsafe í•¨
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }).start();
  }
}

//ì¶œë ¥
// StringBuffer.length: 20000
// StringBuilder.length: 19628
```
- StringBuilderì˜ ì¶œë ¥ ê°’ì´ ë” ì‘ë‹¤.
- ì“°ë ˆë“œë“¤ì´ ë™ì‹œì— StringBuilder í´ë˜ìŠ¤ì— ì ‘ê·¼í•˜ì—¬ ë™ì‹œì— append() ìˆ˜í–‰ ì¤‘ ëˆ„ë½
- StringBuilderëŠ” thread safe í•˜ì§€ ì•Šì•„ì„œ ê°ê¸° ì“°ë ˆë“œê°€ ê°ì²´ì— ì ‘ê·¼í•´ì„œ ë³€ê²½ì„ í•˜ë©´ ê¸°ë‹¤ë ¤ì£¼ì§€ ì•Šê¸° ë•Œë¬¸
  
---

# Q2. thread-safe ë€?

### âœ… ë‹µë³€ !
ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— í•´ë‹¹ ì½”ë“œë‚˜ ë°ì´í„°ë¥¼ ì ‘ê·¼í•˜ë”ë¼ë„ í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ ê²°ê³¼ê°€ ì˜¬ë°”ë¥´ê²Œ ìœ ì§€ë˜ëŠ” ê²ƒì„ ì˜ë¯¸

ì½”ë“œê°€ ì—¬ëŸ¬ ìŠ¤ë ˆë“œë¡œë¶€í„° ë™ì‹œì— í˜¸ì¶œë˜ë”ë¼ë„ ê° ìŠ¤ë ˆë“œì˜ ì‹¤í–‰ ê²½ë¡œê°€ ì„œë¡œë¥¼ ë°©í•´í•˜ì§€ ì•Šë„ë¡ ì•ˆì „í•˜ê²Œ ì„¤ê³„ë˜ì–´ ìˆë‹¤ëŠ” ê²ƒ

â†’ ë°ì´í„° ë¬´ê²°ì„± & ì¼ê´€ì„±

---

## ğŸ” ì¶”ê°€ ì„¤ëª…

### thread-safeë¥¼ ë³´ì¥í•˜ê¸° ìœ„í•œ ë°©ë²•
1. **ìƒí˜¸ë°°ì œ (Mutual Exclusion)**  
   - ì„¸ë§ˆí¬ì–´, ë®¤í…ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ê³µìœ  ìì›ì— í•˜ë‚˜ì˜ threadë§Œ ì ‘ê·¼ í—ˆìš©  
2. **ë™ê¸°í™” (Synchronization)**  
3. **ë¶ˆë³€ì„± (Immutability)**  
4. **ìŠ¤ë ˆë“œ ë¡œì»¬ ì €ì¥ì†Œ (ThreadLocal)**  
5. **ì›ìì  ì—°ì‚° (Atomic Operation)**  

ğŸ“Œ ì°¸ê³  ë§í¬  
- https://developer-ellen.tistory.com/205  
- [ìŠ¤ë ˆë“œ ì„¸ì´í”„ë€?](https://happydhkim.tistory.com/entry/%EC%8A%A4%EB%A0%88%EB%93%9C-%EC%84%B8%EC%9D%B4%ED%94%84Thred-Safe%EB%9E%80)

---

### Javaì—ì„œ thread-safeí•˜ê²Œ ì„¤ê³„í•˜ëŠ” ë°©ë²•
1. **`java.util.concurrent` íŒ¨í‚¤ì§€ í™œìš©**  

  ```java
   Map<K,V> map = new ConcurrentHashMap<K,V>();
   Queue<E> queue = new ConcurrentQueue<E>();
  ``` 

- Concurrent ìë£Œêµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ë©´ ë™ì‹œ ì‘ì—…í•  ìˆ˜ ìˆëŠ” ìŠ¤ë ˆë“œ ì–‘ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.
- ë³‘ë ¬ì„±ì„ ìµœëŒ€í•œ í™•ë³´í•œ ìë£Œ êµ¬ì¡°

2. **ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¥¼ ë‘ì§€ ì•ŠëŠ”ë‹¤**  
- `private final` ì‚¬ìš©  
- ë°ì´í„°ë¥¼ ë°”ê¿€ ìˆ˜ ìˆëŠ” setter ë©”ì†Œë“œ ì œê³µí•˜ì§€ ì•Šê¸° 

3. **Singleton íŒ¨í„´ ì‚¬ìš©**  
- `enum` í™œìš© (JVM ë³´ì¥, thread-safe ìë™ í™•ë³´)  

4. **ë™ê¸°í™” ë¸”ëŸ­ì—ì„œ ì—°ì‚° ìˆ˜í–‰**  
- `synchronized` í‚¤ì›Œë“œ ì‚¬ìš© (ë©”ì„œë“œ, ì½”ë“œ ë¸”ëŸ­)  
- ìŠ¤ë ˆë“œê°€ synchronized ìë£Œêµ¬ì¡°ì— ì ‘ê·¼í•˜ë©´ lockì„ ê±¸ê³  ë‹¤ë¥¸ ìŠ¤ë ˆë“œì˜ ì ‘ê·¼ì„ ì œí•œí•œë‹¤.

   ```java
    public static synchronized void add(int value){
      count += value;
    }
   ```

---
